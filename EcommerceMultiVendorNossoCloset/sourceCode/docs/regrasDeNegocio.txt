# üõçÔ∏è **PLANEJAMENTO COMPLETO - SISTEMA NOSSO CLOSET**

## **ESPECIFICA√á√ïES T√âCNICAS REFINADAS**

### **Stack Tecnol√≥gica para Alta Escalabilidade**
- **Backend**: Java 17+ ou 21 com Spring Boot 3.x
- **Database**: PostgreSQL (produ√ß√£o) + H2 (testes)
- **Cache**: Redis para sess√µes e dados frequentes
- **ORM**: JPA/Hibernate com otimiza√ß√µes para 1400+ clientes
- **Queue**: RabbitMQ para processamento ass√≠ncrono
- **Storage**: goole drive API
- **Frontend**: React.js OU VITE com Redux para gerenciamento de estado
- **Mobile**: PWA responsivo para acesso mobile
- **Notifica√ß√µes**: Twilio (WhatsApp) + JavaMailSender
- **Monitoramento**: Actuator + Micrometer

---

## üìã **REGRAS DE NEG√ìCIO DETALHADAS - NOSSO CLOSET**

### **1. MODELO OPERACIONAL ESPEC√çFICO**

#### **Fluxo Financeiro da Empresa**
A **Nosso Closet** opera com **antecipa√ß√£o de pagamento**, onde:
- Empresa identifica demanda atrav√©s dos pedidos coletivos
- **Administradores pagam fornecedores** imediatamente ap√≥s confirma√ß√£o do pedido
- Produtos s√£o solicitados aos fornecedores via WhatsApp ou sites
- Clientes pagam **ap√≥s** o pedido ser feito aos fornecedores
- **Capital de giro pr√≥prio** √© utilizado para viabilizar as compras
- Margem de lucro vem das taxas administrativas aplicadas

**Implementa√ß√£o**: Sistema deve ter controle rigoroso de **fluxo de caixa**, com dashboards mostrando valores antecipados por pedido, valores a receber de clientes, e margem real por opera√ß√£o.

#### **Gest√£o de M√∫ltiplos Operadores**
Com **1400 clientes ativos**, o sistema deve suportar:
- **M√∫ltiplos administradores** simult√¢neos
- **Controle de sess√µes** para evitar conflitos
- **Auditoria completa** de todas as a√ß√µes administrativas
- **Permiss√µes granulares** por funcionalidade
- **Dashboard em tempo real** para monitoramento conjunto

### **2. SISTEMA DE PEDIDOS PERSONALIZADOS**

#### **Interface de Pedido do Cliente**
O cliente deve poder fazer pedidos **detalhados** atrav√©s da interface:

**Campos Obrigat√≥rios**:
- **Upload de imagem** da pe√ßa desejada (print/foto)
- **Refer√™ncia da pe√ßa** (se dispon√≠vel no site do fornecedor)
- **Descri√ß√£o detalhada** da pe√ßa
- **Cor preferencial** (com op√ß√µes de cores alternativas)
- **Tamanho desejado** (com tabela de medidas)
- **Categoria** (roupas femininas, masculinas, infantis, academia, acess√≥rios, bolsas)
- **Fornecedor preferencial** (se conhecido)
- **Observa√ß√µes especiais**

**Campos Opcionais**:
- **Faixa de pre√ßo** aceit√°vel
- **Urg√™ncia** do pedido
- **Quantidade** (se desejar mais de uma pe√ßa)

**Implementa√ß√£o**: Criar interface intuitiva com **drag-and-drop** para imagens, **autocomplete** para refer√™ncias, e **valida√ß√£o em tempo real** dos campos obrigat√≥rios.

### **3. GEST√ÉO DE VARIA√á√ïES DE PRODUTOS**

#### **Estrutura Hier√°rquica de Produtos**
O sistema deve gerenciar **produtos complexos** com m√∫ltiplas varia√ß√µes:

**Produto Base**:
- Nome gen√©rico (ex: "Vestido Longo Floral")
- Categoria principal
- Fornecedor
- Imagens de refer√™ncia
- Descri√ß√£o base

**Varia√ß√µes do Produto**:
- **Tamanhos**: PP, P, M, G, GG, XG, Plus Size
- **Cores**: Sistema de cores com c√≥digos HEX para precis√£o
- **Modelos**: Diferentes vers√µes do mesmo produto base
- **Materiais**: Cotton, Poli√©ster, Elastano, etc.

**Controle de Estoque por Varia√ß√£o**:
- Estoque individual para cada combina√ß√£o (Produto + Cor + Tamanho)
- **M√≠nimo por fornecedor** calculado considerando todas as varia√ß√µes
- Sistema de **substitui√ß√£o autom√°tica** (se cliente aceita cor similar)

### **4. SISTEMA DE CR√âDITOS E REEMBOLSOS FLEX√çVEL**

#### **Pol√≠tica de Cancelamento Personalizada**
Quando pedido coletivo **n√£o atinge m√≠nimo**:

**Op√ß√µes para o Cliente**:
1. **Reembolso total** via PIX/cart√£o (prazo: 5 dias √∫teis)
2. **Cr√©dito na plataforma** com **b√¥nus de 5%** (incentivo para manter)
3. **Transfer√™ncia para pr√≥ximo pedido** do mesmo fornecedor
4. **Combina√ß√£o**: parte reembolso + parte cr√©dito

**Implementa√ß√£o**: Sistema de **wallet interno** para cada cliente, com controle de cr√©ditos, hist√≥rico de transa√ß√µes, e op√ß√µes de uso flex√≠vel. Dashboard administrativo para aprovar reembolsos caso a caso.

#### **Sistema de Cr√©ditos Avan√ßado**
- **Cr√©ditos por indica√ß√£o** de novos clientes
- **Programa de fidelidade** baseado em volume de compras
- **Cr√©ditos promocionais** para campanhas espec√≠ficas
- **Validade configur√°vel** para diferentes tipos de cr√©dito

### **5. GEST√ÉO DE FORNECEDORES E COMUNICA√á√ÉO**

#### **Perfil Detalhado de Fornecedores**
Cada fornecedor deve ter:
- **Dados b√°sicos**: Nome, contato, WhatsApp, site
- **M√≠nimo de pedido** em valor (R$) ou quantidade
- **Tempo m√©dio de entrega** (dias √∫teis)
- **Categorias de produtos** que oferece
- **Taxa administrativa** espec√≠fica
- **Hist√≥rico de performance** (pontualidade, qualidade)
- **Status ativo/inativo**
- **Observa√ß√µes operacionais**

#### **Sistema de Comunica√ß√£o Integrado**
**Para Fornecedores**:
- **Templates autom√°ticos** para pedidos via WhatsApp
- **Exporta√ß√£o de pedidos** em formato que o fornecedor prefere
- **Controle de confirma√ß√£o** de recebimento do pedido
- **Sistema de follow-up** autom√°tico para prazos

**Para Clientes**:
- **Notifica√ß√µes em tempo real** sobre status do pedido
- **Galeria de produtos** enviados pelo fornecedor
- **Confirma√ß√£o visual** antes da finaliza√ß√£o da compra

---

## üîÑ **FLUXOS DE PROCESSO REFINADOS**

### **Fluxo 1: Pedido Personalizado Completo**

**Etapa 1: Solicita√ß√£o do Cliente**
Cliente acessa plataforma ‚Üí Seleciona "Fazer Pedido Personalizado" ‚Üí Upload da imagem da pe√ßa ‚Üí Preenche formul√°rio detalhado (refer√™ncia, cor, tamanho, categoria) ‚Üí Sistema valida dados obrigat√≥rios ‚Üí Pedido entra na **fila de an√°lise**

**Etapa 2: An√°lise Administrativa**
Administrador visualiza pedido na **fila de an√°lise** ‚Üí Identifica fornecedor adequado ‚Üí Pesquisa pre√ßo e disponibilidade ‚Üí Define **pre√ßo final** com taxa administrativa ‚Üí Adiciona produto ao **pedido coletivo ativo** do fornecedor ‚Üí Notifica cliente sobre **pre√ßo e prazo**

**Etapa 3: Confirma√ß√£o e Agrupamento**
Cliente **confirma interesse** no pre√ßo ‚Üí Sistema adiciona ao pedido coletivo ‚Üí Monitora progresso do **m√≠nimo do fornecedor** ‚Üí Quando m√≠nimo √© atingido, **congela novas adi√ß√µes** ‚Üí Notifica todos os clientes do grupo

**Etapa 4: Pagamento dos Clientes**
Sistema abre **janela de pagamento** (48h) ‚Üí Envia links personalizados via WhatsApp ‚Üí Cliente realiza pagamento ‚Üí Sistema confirma pagamento automaticamente ‚Üí Atualiza status individual

**Etapa 5: Compra do Fornecedor**
Administrador **consolida pedido** ‚Üí Faz pagamento ao fornecedor com **capital pr√≥prio** ‚Üí Envia pedido via WhatsApp/site do fornecedor ‚Üí Registra **valor antecipado** no sistema ‚Üí Aguarda confirma√ß√£o do fornecedor

**Etapa 6: Acompanhamento e Entrega**
Fornecedor confirma pedido e prazo ‚Üí Sistema atualiza status para clientes ‚Üí Produtos chegam ‚Üí Confer√™ncia e separa√ß√£o ‚Üí Notifica√ß√£o de disponibilidade ‚Üí Clientes retiram/recebem ‚Üí Sistema baixa estoque e **fecha fluxo financeiro**

### **Fluxo 2: Gest√£o de Inadimpl√™ncia em Escala**

**Detec√ß√£o Autom√°tica**:
Sistema monitora **1400 clientes** simultaneamente ‚Üí Identifica atrasos via **job autom√°tico** ‚Üí Classifica por **gravidade** (1-3 dias, 4-7 dias, +7 dias) ‚Üí Gera **lista priorizada** para cobran√ßa

**Cobran√ßa Escalonada**:
**Dia 1**: WhatsApp autom√°tico com link de pagamento
**Dia 3**: Email + WhatsApp com **desconto de 5%** se pagar em 24h
**Dia 7**: Liga√ß√£o telef√¥nica + **bloqueio tempor√°rio** da conta
**Dia 15**: **Remo√ß√£o do pedido coletivo** + processo de reembolso/cr√©dito

**Recupera√ß√£o de Cr√©dito**:
Cliente inadimplente pode **negociar parcelamento** ‚Üí Sistema gera **plano de pagamento** ‚Üí Libera conta gradualmente conforme pagamentos ‚Üí Mant√©m **hist√≥rico de comportamento** para futuras an√°lises

### **Fluxo 3: Gest√£o de Estoque Complexo**

**Recebimento de Produtos**:
Fornecedor entrega ‚Üí **Confer√™ncia f√≠sica** item por item ‚Üí Sistema gera **checklist** baseado no pedido ‚Üí Administrador confirma **qualidade e quantidade** ‚Üí Produtos s√£o **etiquetados** com c√≥digo do cliente ‚Üí Separa√ß√£o f√≠sica por **√°rea de retirada**

**Controle de Varia√ß√µes**:
Sistema mant√©m **estoque virtual** (pedidos confirmados) vs **estoque real** (produtos f√≠sicos) ‚Üí **Alertas autom√°ticos** para diverg√™ncias ‚Üí **Relat√≥rio de perdas** para produtos danificados ‚Üí **Sistema de substitui√ß√£o** para produtos indispon√≠veis

---

## üìä **ARQUITETURA DE DADOS PARA ALTA ESCALA**

### **Entidades Principais Otimizadas**

#### **Users (1400+ registros ativos)**
```
- id, name, email, phone, whatsapp
- user_type (CLIENT, ADMIN, SUPER_ADMIN)
- status (ACTIVE, BLOCKED, INACTIVE)
- credit_balance (decimal)
- registration_date, last_access
- delivery_preference (NATAL_PICKUP, FORTALEZA_DELIVERY)
- payment_history_summary (JSON)
```

#### **Suppliers (50-100 fornecedores estimados)**
```
- id, name, contact_name, whatsapp, website
- minimum_order_value (decimal)
- delivery_time_days (integer)
- admin_fee_percentage (decimal)
- categories (JSON array)
- performance_rating (1-5)
- status, notes
```

#### **CustomOrders (Pedidos Personalizados)**
```
- id, client_id, supplier_id (nullable)
- product_image_url, reference_code
- description, preferred_color, size
- category, observations
- estimated_price, final_price
- status (PENDING_ANALYSIS, PRICED, CONFIRMED, IN_COLLECTIVE)
- created_at, analyzed_at
```

#### **CollectiveOrders (Pedidos Coletivos por Fornecedor)**
```
- id, supplier_id, status
- minimum_value, current_value
- payment_deadline, supplier_payment_date
- anticipated_amount (valor que a empresa pagou)
- total_received (valor recebido dos clientes)
- profit_margin, created_at
```

#### **OrderItems (Itens Individuais dos Clientes)**
```
- id, collective_order_id, client_id, custom_order_id
- quantity, unit_price, total_price
- payment_status, payment_date
- delivery_preference, tracking_code
- status (PENDING_PAYMENT, PAID, DELIVERED, RETURNED)
```

#### **CreditTransactions (Movimenta√ß√£o de Cr√©ditos)**
```
- id, client_id, transaction_type
- amount, description, reference_order_id
- created_at, expires_at
- status (ACTIVE, USED, EXPIRED)
```

#### **SystemAudit (Auditoria para M√∫ltiplos Admins)**
```
- id, admin_id, action_type, entity_type
- entity_id, old_values (JSON), new_values (JSON)
- timestamp, ip_address
```

---

## üéØ **ROADMAP DE DESENVOLVIMENTO REVISADO**

### **FASE 1: INFRAESTRUTURA E AUTENTICA√á√ÉO (4 semanas)**

**Semana 1: Setup Avan√ßado**
- Configurar **Spring Boot 3.x** com **PostgreSQL**
- Implementar **Redis** para cache de sess√µes
- Configurar **RabbitMQ** para filas de processamento
- Setup de GOOGLE DRIVE API PARA UPLOAD E ARMAZENAMENTO DE CAT√ÅLOGOS (PDFS) E IMAGENS
- Configurar **monitoramento** com Actuator

**Semana 2: Sistema de Autentica√ß√£o Robusto**
- JWT com **refresh tokens**
- **M√∫ltiplas sess√µes** simult√¢neas para admins
- **Rate limiting** para APIs p√∫blicas
- Sistema de **permiss√µes granulares**
- **Auditoria completa** de a√ß√µes

**Semana 3: Gest√£o de Usu√°rios em Escala**
- CRUD otimizado para **1400+ clientes**
- **Busca avan√ßada** com filtros m√∫ltiplos
- **Pagina√ß√£o eficiente** com cursor-based pagination
- **Dashboard de usu√°rios** com m√©tricas em tempo real
- Sistema de **bloqueio/desbloqueio** em lote

**Semana 4: Sistema de Upload e Storage**
- **Upload m√∫ltiplo** de imagens com preview
- **Compress√£o autom√°tica** de imagens
- **CDN** para entrega r√°pida de imagens
- **Valida√ß√£o de formato** e tamanho
- **Backup autom√°tico** de arquivos

### **FASE 2: CORE BUSINESS - PEDIDOS PERSONALIZADOS (5 semanas)**

**Semana 5: Interface de Pedidos Personalizados**
- **Formul√°rio intuitivo** com valida√ß√£o em tempo real
- **Drag-and-drop** para upload de imagens
- **Autocomplete** para refer√™ncias de produtos
- **Tabela de medidas** interativa
- **Preview** do pedido antes de enviar

**Semana 6: Sistema de An√°lise Administrativa**
- **Fila de pedidos** para an√°lise
- **Interface de precifica√ß√£o** r√°pida
- **Pesquisa autom√°tica** em sites de fornecedores
- **Calculadora de margem** em tempo real
- **Sistema de aprova√ß√£o** em lote

**Semana 7: Gest√£o de Fornecedores Avan√ßada**
- **CRUD completo** com performance tracking
- **Sistema de comunica√ß√£o** integrado
- **Templates** personaliz√°veis para WhatsApp
- **Controle de m√≠nimos** por fornecedor
- **Hist√≥rico de pedidos** e performance

**Semana 8: Pedidos Coletivos Inteligentes**
- **Agrupamento autom√°tico** por fornecedor
- **C√°lculo din√¢mico** de m√≠nimos
- **Sistema de notifica√ß√µes** em massa
- **Controle de prazos** automatizado
- **Dashboard** de acompanhamento

**Semana 9: Sistema de Varia√ß√µes Complexo**
- **Matriz de varia√ß√µes** (cor x tamanho x modelo)
- **Controle de estoque** por varia√ß√£o
- **Sistema de substitui√ß√£o** autom√°tica
- **Relat√≥rios de disponibilidade**
- **Alertas de estoque baixo**

### **FASE 3: SISTEMA FINANCEIRO ROBUSTO (4 semanas)**

**Semana 10: Gateway de Pagamentos**
- Integra√ß√£o com **Mercado Pago** e **PagSeguro**
- **Webhook** para confirma√ß√£o autom√°tica
- **Retry autom√°tico** para pagamentos falhos
- **Dashboard financeiro** em tempo real
- **Concilia√ß√£o autom√°tica**

**Semana 11: Sistema de Cr√©ditos e Wallet**
- **Wallet interno** para cada cliente
- **M√∫ltiplos tipos** de cr√©dito
- **Sistema de validade** configur√°vel
- **Transfer√™ncia** entre clientes
- **Relat√≥rios de utiliza√ß√£o**

**Semana 12: Controle de Fluxo de Caixa**
- **Dashboard de antecipa√ß√µes** pagas
- **Controle de recebimentos** de clientes
- **C√°lculo autom√°tico** de margem real
- **Proje√ß√µes financeiras**
- **Alertas de fluxo de caixa**

**Semana 13: Sistema de Cobran√ßa Automatizada**
- **Cobran√ßa escalonada** autom√°tica
- **Templates personaliz√°veis** de cobran√ßa
- **Integra√ß√£o com WhatsApp** para lembretes
- **Negocia√ß√£o de parcelamento**
- **Relat√≥rios de inadimpl√™ncia**

### **FASE 4: LOG√çSTICA E OPERA√á√ïES (3 semanas)**

**Semana 14: Sistema Multi-Localiza√ß√£o**
- **C√°lculo de frete** para Fortaleza
- **Integra√ß√£o com Correios**
- **Rastreamento autom√°tico**
- **Agendamento de retiradas**
- **Controle de hor√°rios**

**Semana 15: Gest√£o de Estoque F√≠sico**
- **C√≥digo de barras** para produtos
- **Sistema de separa√ß√£o** por cliente
- **Controle de qualidade** no recebimento
- **Alertas de diverg√™ncia**
- **Relat√≥rios de perdas**

**Semana 16: Sistema de Devolu√ß√µes**
- **Fluxo automatizado** de devolu√ß√£o
- **An√°lise baseada em regras**
- **Processo de reembolso** integrado
- **Controle de qualidade** de devolu√ß√µes
- **M√©tricas de satisfa√ß√£o**

### **FASE 5: OTIMIZA√á√ÉO E ANALYTICS (3 semanas)**

**Semana 17: Performance e Escalabilidade**
- **Otimiza√ß√£o de queries** para 1400+ usu√°rios
- **Cache inteligente** com Redis
- **Processamento ass√≠ncrono** com RabbitMQ
- **Monitoramento de performance**
- **Auto-scaling** de recursos

**Semana 18: Dashboards Executivos**
- **M√©tricas em tempo real**
- **Relat√≥rios automatizados**
- **An√°lise de tend√™ncias**
- **Proje√ß√µes de crescimento**
- **KPIs operacionais**

**Semana 19: Sistema de Notifica√ß√µes Avan√ßado**
- **Notifica√ß√µes push** via PWA
- **Personaliza√ß√£o** por cliente
- **Hor√°rios inteligentes** de envio
- **Templates din√¢micos**
- **M√©tricas de engajamento**

---

## üîß **CONFIGURA√á√ïES ESPEC√çFICAS DO SISTEMA**

### **Par√¢metros Operacionais da Nosso Closet**

**Regras de Pedido Coletivo**:
- **Janela de pagamento**: 48 horas (configur√°vel)
- **Percentual m√≠nimo** para confirma√ß√£o: 80% dos clientes
- **Tempo m√°ximo** de an√°lise de pedidos: 24 horas
- **Limite de pedidos** por cliente por fornecedor: 10 itens

**Regras Financeiras**:
- **Taxa administrativa padr√£o**: 15-25% (configur√°vel por fornecedor)
- **B√¥nus de cr√©dito**: 5% para quem aceita cr√©dito em vez de reembolso
- **Desconto por pontualidade**: 5% se pagar em 24h ap√≥s cobran√ßa
- **Taxa de frete Fortaleza**: R$ 15,00 fixo (configur√°vel)

**Regras de Comunica√ß√£o**:
- **Hor√°rio de WhatsApp**: 8h √†s 20h (dias √∫teis), 9h √†s 18h (fins de semana)
- **Frequ√™ncia de cobran√ßa**: Dias 1, 3, 7, 15
- **Limite de mensagens**: 3 por dia por cliente
- **Template personalizado** por tipo de fornecedor

**Regras de Qualidade**:
- **Prazo m√°ximo** para confer√™ncia: 48h ap√≥s chegada
- **Toler√¢ncia de diverg√™ncia**: 5% em valor
- **Tempo de armazenamento**: 30 dias ap√≥s notifica√ß√£o
- **Crit√©rios de devolu√ß√£o**: Defeito, tamanho errado, produto diferente

---

## üìà **M√âTRICAS E KPIs ESSENCIAIS**

### **Operacionais**
- **Taxa de convers√£o** pedido personalizado ‚Üí compra efetiva
- **Tempo m√©dio** de an√°lise de pedidos
- **Percentual de atingimento** de m√≠nimos por fornecedor
- **Taxa de inadimpl√™ncia** por per√≠odo
- **Satisfa√ß√£o do cliente** (NPS)

### **Financeiros**
- **Margem real** por pedido coletivo
- **Tempo de retorno** do capital antecipado
- **Volume de cr√©ditos** n√£o utilizados
- **Taxa de reembolso** vs cr√©dito
- **Fluxo de caixa** projetado vs real

### **Log√≠sticos**
- **Tempo m√©dio** de entrega por fornecedor
- **Taxa de diverg√™ncia** no recebimento
- **Percentual de devolu√ß√µes** por motivo
- **Efici√™ncia de separa√ß√£o** de produtos
- **Taxa de retirada** vs envio

Este planejamento refinado considera a **realidade operacional** da Nosso Closet, com foco na **escalabilidade** para 1400+ clientes ativos e na **flexibilidade** necess√°ria para um modelo de neg√≥cio baseado em antecipa√ß√£o de capital e personaliza√ß√£o de pedidos.